<aside class="sidebar" [class.sidebar--collapsed]="isCollapsed" role="navigation" aria-label="Navegación principal del viaje">
  <!-- Botón de colapsar/expandir -->
  <button 
    class="sidebar__collapse-button" 
    (click)="toggleSidebar()"
    aria-label="Colapsar/Expandir menú de navegación"
    [attr.aria-expanded]="!isCollapsed"
    [title]="isCollapsed ? 'Expandir menú' : 'Colapsar menú'"
  >
    <svg class="sidebar__collapse-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path *ngIf="!isCollapsed" d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path *ngIf="isCollapsed" d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <!-- Header del Viaje -->
  <div class="sidebar__trip-header" *ngIf="tripInfo">
    <button 
      class="sidebar__toggle" 
      (click)="toggleSidebar()"
      aria-label="Colapsar/Expandir menú del viaje"
      [attr.aria-expanded]="!isCollapsed"
      [title]="isCollapsed ? 'Expandir menú' : 'Colapsar menú'"
    >
      <span class="sidebar__toggle-icon">{{ isCollapsed ? '☰' : '✕' }}</span>
    </button>
    
    <div class="sidebar__trip-info" *ngIf="!isCollapsed">
      <h2 class="sidebar__trip-title">{{ tripInfo.title }}</h2>
      <p class="sidebar__trip-destination">{{ getDestination() }}</p>
      <p class="sidebar__trip-dates">{{ getFormattedDates() }}</p>
    </div>
  </div>

  <!-- Enlaces de Navegación -->
  <nav class="sidebar__nav" *ngIf="navLinks.length > 0">
    <ul class="sidebar__list">
      <li class="sidebar__item" *ngFor="let link of navLinks">
        <a 
          [routerLink]="link.route"
          routerLinkActive="sidebar__link--active"
          [routerLinkActiveOptions]="{ exact: true }"
          class="sidebar__link"
          [title]="link.label"
        >
          <img class="sidebar__icon" [src]="link.icon" [alt]="link.label">
          <span class="sidebar__label" *ngIf="!isCollapsed">{{ link.label }}</span>
          <span class="sidebar__badge" *ngIf="link.badge && link.badge > 0 && !isCollapsed">
            {{ link.badge }}
          </span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Footer con botones de Guardar y Chat -->
  <div class="sidebar__footer">
    <button 
      class="sidebar__save-button"
      [disabled]="isSaved || isAutoSaving"
      (click)="saveChanges()"
      [title]="isSaved ? 'No hay cambios para guardar' : 'Guardar cambios'"
    >
      <svg class="sidebar__save-icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
      </svg>
      <span class="sidebar__save-label" *ngIf="!isCollapsed">
        {{ isAutoSaving ? 'Guardando...' : 'Guardar' }}
      </span>
    </button>

    <button 
      class="sidebar__chat-button" 
      (click)="openChat()"
      aria-label="Abrir chat"
      [title]="isCollapsed ? 'Chat' : 'Abrir chat del viaje'"
    >
      <img class="sidebar__chat-icon" src="/assets/icons/sidebar/chat.svg" alt="Chat">
      <span class="sidebar__chat-label" *ngIf="!isCollapsed">Chat</span>
    </button>
  </div>
</aside>
